# kubernetes EDR

محیط های کوبرنتیز و کانتینر در خیلی از سازمانها رها شده اند در سلسله مقالاتی خطراتی که متوجه این سازمانها هستند را بررسی میکنم 

خطرات نبود EDR در محیط‌های Kubernetes

نبود EDR در محیط‌های Kubernetes یکی از شکاف‌های امنیتی رایج، اما بسیار پرریسک است؛ زیرا معماری Container‑Based با سرعت بالا، ماهیت Ephemeral و توزیع‌شده خود نقطه‌های کور زیادی ایجاد می‌کند. در چنین محیطی، نبود EDR باعث می‌شود بخش کلیدی از زنجیره تله‌متری و کنترل تهدید از بین برود. مهم‌ترین خطرات عبارت‌اند از:

1. عدم توانایی در شناسایی رفتارهای مخرب داخل Pod 
حملات Runtime مانند اجرای Shell در کانتینر، تغییر مسیرهای فایل، اجرای ابزارهای مهاجم (curl/wget/nc) و سوءاستفاده از کتابخانه‌ها قابل مشاهده نیستند.

2. چشم‌پوشی کامل از حملات Drift Runtime
 
 اگر یک کانتینر رفتار متفاوتی از Image پایه انجام دهد (مثل دانلود باینری جدید، ایجاد کانکشن غیرمعمول)، بدون EDR هیچ‌کس متوجه نمی‌شود.

3. ناتوانی در تشخیص حرکت جانبی (Lateral Movement) داخل کلاستر 
   مهاجم با دسترسی به یک Pod می‌تواند:  
   • به Kubelet دسترسی بگیرد  
   • وSecrets را استخراج کند  
   • به سرویس‌های مجاور Pivot کند  
   بدون اینکه SIEM یا NIDS چیزی ببیند.

4. عدم مشاهده تهدیدات مبتنی بر Node  
   اگر مهاجم از طریق Container Escape وارد Node شود، بدون EDR رفتارهای سیستم‌عاملی Node قابل مشاهده نیست و این یعنی Blind Spot کامل.

5. ریسک Exfiltration نامحسوس 
   کانتینر آلوده می‌تواند داده را به‌صورت Low‑and‑Slow خارج کند؛ معمولاً در Long Tail قرار می‌گیرد و شما دست خالی هستید .

6. وضعیت فاجعه‌بار در برابر APT و حملات Supply Chain 
   حملاتی مثل:  
   • آلوده شدن Base Image  
   • سوءاستفاده از کتابخانه آلوده  
   • بارگذاری Image از ریجستری جعلی  
   بدون EDR هیچ‌وقت در Runtime دیده نمی‌شوند.

7. چشم‌پوشی از Indicators of Attack (IoA)
 
   لاگهای Kubernetes  فقط فعالیت‌های Control Plane را نشان می‌دهند  
  ولی هیچ چیز درباره رفتار داخل Pod یا Node نمی‌گویند.

8. مشکل جدی در Incident Response  
   وقتی EDR نباشد:  
   • مساله Capture کردن Memory 
   • و Timeline ناقص  
   • فهم Pivot مهاجم تقریباً غیرممکن  
   یعنی Incident Response فقط «حدس» است، نه Investigation.


**امروزه به جای واژه EDR در محیط کوبرنتیز، بیشتر از ابزارهای Runtime Security یا CWPP (Cloud Workload Protection Platforms) استفاده می‌شود
